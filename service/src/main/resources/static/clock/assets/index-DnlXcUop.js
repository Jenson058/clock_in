var J=Object.defineProperty;var N=(n,t,e)=>t in n?J(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var _=(n,t,e)=>(N(n,typeof t!="symbol"?t+"":t,e),e);import{J as O,P as R}from"./JensonTable-BT5Pky2i.js";import{C as w,S as $,d as S,r as v,K as k,A as D,J as B,M as j,N as z,O as E,g,o as V,c as x,b as d,w as c,y as M,h as U,_ as L,P as C,F as T,Q as q,R as H,T as K,k as Q,H as G,l as F}from"./index-Cbuz69k2.js";import{_ as W}from"./JensonEditModel.vue_vue_type_script_setup_true_lang-Bezn-LtO.js";var X=Object.defineProperty,Y=Object.getOwnPropertyDescriptor,P=(n,t,e,l)=>{for(var o=l>1?void 0:l?Y(t,e):t,r=n.length-1,m;r>=0;r--)(m=n[r])&&(o=(l?m(t,e,o):m(o))||o);return l&&o&&X(t,e,o),o};class b{constructor(){_(this,"id");_(this,"fileId");_(this,"version");_(this,"updatedAt")}}P([w.label("版本"),w.prop()],b.prototype,"version",2);P([w.label("修改日期"),w.prop()],b.prototype,"updatedAt",2);class Z extends ${}const ee={key:0},te=S({__name:"JensonFileUpload",props:{type:{},modelValue:{},disabled:{type:Boolean,default:!1},limit:{default:1}},emits:["update:modelValue"],setup(n,{emit:t}){const e=v([]),l=n,o=t,r=k({get(){return l.modelValue},set(a){o("update:modelValue",a)}});D(async()=>{await m(r.value)});async function m(a){if(!a){e.value=[];return}const u=B.stringToNumberList(a);let p=new q;p.idList=u;const s=await j.listAll(p),h=s==null?void 0:s.content;e.value=h==null?void 0:h.map(I=>z.toUploadFile(I)??[])}function y(a){return a.split(".").slice(-1)[0]}async function f(a){let u=a.file,p=new H(a.file.name,"",a.file.type,y(a.file.name),0,0);return await K(u,p)}E(e,a=>{r.value=B.listToString(a.map(u=>u.response))},{deep:!0});function i(){return e.value.length>=l.limit}return(a,u)=>{const p=g("el-upload");return V(),x(T,null,[d(p,{action:"/","file-list":e.value,"onUpdate:fileList":u[0]||(u[0]=s=>e.value=s),multiple:!0,limit:l.limit,"http-request":f,disabled:l.disabled,class:"display"},{default:c(()=>[i()||l.disabled?C("",!0):(V(),M(L,{key:0,type:"primary",size:"large"},{default:c(()=>[U("点击上传")]),_:1}))]),_:1},8,["file-list","limit","disabled"]),e.value.length==0&&l.disabled?(V(),x("span",ee,"暂无数据")):C("",!0)],64)}}}),le=Q(te,[["__scopeId","data-v-ab8d1f88"]]);class ae extends G{constructor(){super("renewal")}}const A=new ae,ue=S({__name:"index",setup(n){const t=v(new R),e=v(!1),l=v(new b),o=v([]);function r(){let f=new Z(t.value.page,t.value.pageSize);A.pageAll(f).then(function(i){o.value=i.content.content,t.value.total=i.content.totalElements})}function m(){l.value=new b,e.value=!0}function y(){let f={...l.value};A.edit(f).then(function(i){r()})}return(f,i)=>{const a=g("el-form-item"),u=g("el-input"),p=g("el-form");return V(),x(T,null,[d(O,{index:"","column-list":F(w).getColumnList(F(b)),"page-config":t.value,view:"",setting:"",refresh:"","table-data":o.value,onInitTable:r},{"header-add":c(()=>[d(L,{type:"primary",onClick:m},{default:c(()=>[U(" 上传版本 ")]),_:1})]),_:1},8,["column-list","page-config","table-data"]),d(W,{modelValue:e.value,"onUpdate:modelValue":i[2]||(i[2]=s=>e.value=s),style:{width:"400px"},title:"上传版本",footer:{submit:!0,info:!0},"submit-on-click":y},{default:c(()=>[d(p,null,{default:c(()=>[d(a,{label:"上传文件"},{default:c(()=>[d(le,{type:"file",limit:1,modelValue:l.value.fileId,"onUpdate:modelValue":i[0]||(i[0]=s=>l.value.fileId=s)},null,8,["modelValue"])]),_:1}),d(a,{label:"版本信息"},{default:c(()=>[d(u,{modelValue:l.value.version,"onUpdate:modelValue":i[1]||(i[1]=s=>l.value.version=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});export{ue as default};
